This repository contains a ProVerif model and the analysis of the authentication protocol proposed in Wang, W., Chen, Q., Yin, Z., Srivastava, G., Gadekallu, T. R., Alsolami, F., & Su, C. *“Blockchain and PUF-based Lightweight Authentication Protocol for Wireless Medical Sensor Networks,”* IEEE Internet of Things Journal, vol. 9, no. 11, pp. 8883 – 8891, 2022. <https://doi.org/10.1109/JIOT.2021.3117762>

# ProVerif Model and Analysis

| File / folder | Purpose |
|---------------|---------|
| `wang.pv` | ProVerif model of the Wang et al. blockchain- and PUF-based authentication protocol. |
| `traces/` | Example attack and proof traces generated by ProVerif. |
| `run.bat` | One-command script to reproduce the analysis. |


---

## Quick start

```
git clone https://github.com/mknezevic/proverif-wang.git
cd proverif-wang
.\run.bat      # runs ProVerif 2.05 and stores traces into traces\ subdir
```

## Requirements
[ProVerif 2.05](https://bblanche.gitlabpages.inria.fr/proverif/) must be installed and available in your system PATH.

## Queries and Security Analysis

This ProVerif model in file `wang.pv` includes a set of queries that evaluate core security properties of the authentication protocol proposed by Wang et al.

### Secrecy Queries
The following queries check whether secret auth. parameters such as PUF challenge-response pairs and biometric data are leaked to the attacker:

```
query attacker(pair(S_C1, S_R1)).
query attacker(pair(MP_C1, MP_R1)).
query attacker(MP_BIO). 
```

### Authentication Queries

These use *injective correspondence* to verify that each successful authentication implies a unique start of the corresponding session:

```
query inj-event(MP_auth_end()) ==> inj-event(MP_auth_start()).
query inj-event(S_auth_end()) ==> inj-event(S_auth_start()).
query inj-event(GW_auth_end()) ==> inj-event(GW_auth_start()).
```
If a query returns false, it indicates an impersonation attack.

### Session Key Leakage

To track whether a session key is compromised, the following event-based query is used:

```
query x: key; attacker(x) && event(sessionKeyGenerated(x)).
```

This checks whether a session key generated during protocol execution becomes known to the attacker.

### Verification Summary

Below is the summary of verification results produced by ProVerif:

```
Query not attacker(pair(S_C1[],S_R1[])) is false.

Query not attacker(pair(MP_C1[],MP_R1[])) is false.

Query not attacker(MP_BIO[]) is false.

Query inj-event(MP_auth_end) ==> inj-event(MP_auth_start) is false.

Query inj-event(GW_auth_end) ==> inj-event(GW_auth_start) is false.

Query inj-event(S_auth_end) ==> inj-event(S_auth_start) is false.

Query not (event(sessionKeyGenerated(x)) && attacker(x)) is false.
```

Each `false` result indicates that the corresponding property **does not hold** in the current protocol model. This means:

- **Sensitive values** such as challenge-response pairs and biometric data are exposed to the attacker.
- **Authentication properties** are violated — e.g., a party may complete a session without a proper initiation (impersonation).
- The **session key** can be derived by the attacker.

These results demonstrate security weaknesses in the original protocol design. For details, refer to the generated traces in the `traces\` folder.



